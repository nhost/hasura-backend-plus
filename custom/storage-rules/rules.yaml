functions:
  isAuthenticated: 'return !!request.auth'
  isOwner:
    params:
      - userId
    code: "return !!request.auth && userId === request.auth['x-hasura-user-id']"
  validToken: 'return request.query.token === resource.Metadata.token'
paths:
  /user/:userId/:fileId:
    read: 'isOwner(userId) || validToken()'
    write: 'isOwner(userId)'
    meta:
      read: 'isOwner(userId)'
      write: 'isOwner(userId)'
      values:
        token: 'request.query.token'
  /upload:
    create: 'isAuthenticated()'
